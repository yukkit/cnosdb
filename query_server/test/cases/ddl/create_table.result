-- EXECUTE SQL: DROP DATABASE IF EXISTS createtable; --
200 OK


-- EXECUTE SQL: CREATE DATABASE createtable; --
200 OK


-- EXECUTE SQL: CREATE TABLE createtable."tesT"; --
200 OK


-- EXECUTE SQL: CREATE TABLE createtable.tesT; --
200 OK


-- EXECUTE SQL: SHOW TABLES; --
-- AFTER_SORT --
200 OK
Table
tesT
test

-- EXECUTE SQL: CREATE TABLE test0( column1 BIGINT CODEC(DELTA), column2 STRING CODEC(GZIP), column3 BIGINT UNSIGNED CODEC(NULL), column4 BOOLEAN, column5 DOUBLE CODEC(GORILLA), TAGS(column6, column7)); --
200 OK


-- EXECUTE SQL: insert createtable.test0(TIME, column1, column2, column3, column4, column5, column6, column7) values (100, -1234, 'hello', 1234, false, 1.2, 'beijing', 'shanghai'); --
-- AFTER_SORT --
200 OK
rows
1

-- EXECUTE SQL: insert createtable.test0(TIME, column1, column2, column3, column4, column5, column6, column7) values (101, -1234, 'hello', -1234, false, 1.2, 'beijing', 'shanghai'); --
-- AFTER_SORT --
422 Unprocessable Entity
{"error_code":"0100000","error_message":"Error executiong query: Failed to do execute statement, err:Failed to do execution. err: Arrow err: External error: Arrow error: Cast error: Can't cast value -1234 to type UInt64"}
-- ERROR:  --

-- EXECUTE SQL: insert createtable.test0(TIME, column1, column2, column3, column4, column5, column6, column7) values (102, -1234, 'hello', 1234, false, 'failed', 'beijing', 'shanghai'); --
-- AFTER_SORT --
422 Unprocessable Entity
{"error_code":"0100000","error_message":"Error executiong query: Failed to do execute statement, err:Failed to do execution. err: Arrow err: External error: Arrow error: Cast error: Cannot cast string 'failed' to value of Float64 type"}
-- ERROR:  --

-- EXECUTE SQL: insert createtable.test0(TIME, column1, column2, column3, column4, column5, column6, column7) values (0.1, -1234, 'hello', 1234, true, 1.2, 'beijing', 'shanghai'); --
-- AFTER_SORT --
422 Unprocessable Entity
{"error_code":"0100000","error_message":"Error executiong query: Failed to do execute statement, err:Failed to do physical plan. err: This feature is not implemented: Unsupported CAST from Float64 to Timestamp(Nanosecond, None)"}
-- ERROR:  --

-- EXECUTE SQL: insert createtable.test0(TIME, column1, column2, column3, column4, column5, column6, column7) values (103, -1234, 'hello', 1234, false, 1.2, 'beijing', 'shanghai'); --
-- AFTER_SORT --
200 OK
rows
1

-- EXECUTE SQL: insert createtable.test0(TIME, column1, column2, column3, column4, column5, column6, column7) values (104, -1234, 'hello', 1234, false, 1.2, 'beijing', 'shanghai'); --
-- AFTER_SORT --
200 OK
rows
1

-- EXECUTE SQL: insert createtable.test0(TIME, column2, column3, column4, column5, column6) values (100, 'hello', 1234, false, 1.2, 'beijing'); --
-- AFTER_SORT --
200 OK
rows
1

-- EXECUTE SQL: insert createtable.test0(TIME, column1, column2, column3, column4, column5) values (100, -1234, 'hello', 1234, false, 1.2); --
-- AFTER_SORT --
422 Unprocessable Entity
{"error_code":"0100000","error_message":"Error executiong query: Failed to do execute statement, err:Failed to do execution. err: Arrow err: External error: Arrow error: External error: Tskv operator, err: tags or fields can't be empty"}
-- ERROR:  --

-- EXECUTE SQL: select ALL * from createtable.test0; --
-- AFTER_SORT --
200 OK
time,column6,column7,column1,column2,column3,column4,column5
1970-01-01T00:00:00.000000100,beijing,,,hello,1234,false,1.2
1970-01-01T00:00:00.000000100,beijing,shanghai,-1234,hello,1234,false,1.2
1970-01-01T00:00:00.000000103,beijing,shanghai,-1234,hello,1234,false,1.2
1970-01-01T00:00:00.000000104,beijing,shanghai,-1234,hello,1234,false,1.2

-- EXECUTE SQL: select ALL * from test0; --
-- AFTER_SORT --
200 OK
time,column6,column7,column1,column2,column3,column4,column5
1970-01-01T00:00:00.000000100,beijing,,,hello,1234,false,1.2
1970-01-01T00:00:00.000000100,beijing,shanghai,-1234,hello,1234,false,1.2
1970-01-01T00:00:00.000000103,beijing,shanghai,-1234,hello,1234,false,1.2
1970-01-01T00:00:00.000000104,beijing,shanghai,-1234,hello,1234,false,1.2

-- EXECUTE SQL: select ALL * from public.test0; --
-- AFTER_SORT --
422 Unprocessable Entity
{"error_code":"0100000","error_message":"Error executiong query: Failed to do execute statement, err:Failed to do logical plan. err: External err: Error during planning: failed to resolve user:cnosdb  db: public, table: test0"}
-- ERROR:  --

-- EXECUTE SQL: CREATE TABLE test1( column0 TIMESTAMP CODEC(DELTA), column1 BIGINT CODEC(DELTA), column2 STRING CODEC(GZIP), column3 BIGINT UNSIGNED CODEC(NULL), column4 BOOLEAN, column5 DOUBLE CODEC(GORILLA), TAGS(column6, column7)); --
422 Unprocessable Entity
{"error_code":"0100000","error_message":"Error executiong query: Failed to do execute statement, err:Failed to do parse. err: sql parser error: already have timestamp column"}
-- ERROR:  --

-- EXECUTE SQL: CREATE TABLE test2( column1 BIGINT CODEC(DELTA), column2 STRING CODEC(GZIP), column3 BIGINT UNSIGNED CODEC(NULL), column4 BOOLEAN, column5 DOUBLE CODEC(GORILLA)); --
422 Unprocessable Entity
{"error_code":"0100000","error_message":"Error executiong query: Failed to do execute statement, err:Failed to do parse. err: sql parser error: table should have TAGS"}
-- ERROR:  --

-- EXECUTE SQL: CREATE TABLE test0( column1 BIGINT CODEC(DELTA), column2 STRING CODEC(GZIP), column3 BIGINT UNSIGNED CODEC(NULL), column4 BOOLEAN, column5 DOUBLE CODEC(GORILLA), TAGS(column6, column7)); --
422 Unprocessable Entity
{"error_code":"0100000","error_message":"Error executiong query: Failed to do execute statement, err:Failed to do execution. err: Metadata operator err: Table test0 already exists."}
-- ERROR:  --

-- EXECUTE SQL: CREATE TABLE IF NOT EXISTS test0( column1 BIGINT CODEC(DELTA), column2 STRING CODEC(GZIP), column3 BIGINT UNSIGNED CODEC(NULL), column4 BOOLEAN, column5 DOUBLE CODEC(GORILLA), TAGS(column6, column7)); --
200 OK


-- EXECUTE SQL: CREATE TABLE IF NOT EXISTS test3( column1 BIGINT CODEC(DELTA), column1 BIGINT CODEC(DELTA), column2 STRING CODEC(GZIP), column3 BIGINT UNSIGNED CODEC(NULL), column4 BOOLEAN, column5 DOUBLE CODEC(GORILLA), TAGS(column6, column7)); --
422 Unprocessable Entity
{"error_code":"0100000","error_message":"Error executiong query: Failed to do execute statement, err:Failed to do logical plan. err: Semantic err: Field or Tag name should not have same"}
-- ERROR:  --

-- EXECUTE SQL: CREATE TABLE IF NOT EXISTS test4( column1 BIGINT CODEC(DEL), column2 STRING CODEC(GZIP), column3 BIGINT UNSIGNED CODEC(NULL), column4 BOOLEAN, column5 DOUBLE CODEC(GORILLA), TAGS(column6, column7)); --
422 Unprocessable Entity
{"error_code":"0100000","error_message":"Error executiong query: Failed to do execute statement, err:Failed to do parse. err: sql parser error: s is not valid encoding"}
-- ERROR:  --

-- EXECUTE SQL: CREATE TABLE IF NOT EXISTS test5( column1 BIGINT CODEC(DELTA), column2 STRING CODEC(GZIP), column3 BIGINT UNSIGNED CODEC(NULL), column4 BOOLE, column5 DOUBLE CODEC(GORILLA), TAGS(column6, column7)); --
422 Unprocessable Entity
{"error_code":"0100000","error_message":"Error executiong query: Failed to do execute statement, err:Failed to do parse. err: sql parser error: BOOLE is not a supported type"}
-- ERROR:  --

-- EXECUTE SQL: CREATE TABLE IF NOT EXISTS test6( column1 BIGINT CODEC(delta), column2 STRING CODEC(GZIP), column3 BIGINT UNSIGNED CODEC(null), column4 BOOLEAN CODEC(BITPACK), column5 DOUBLE CODEC(GORILLA), TAGS(column6, column7)); --
200 OK


-- EXECUTE SQL: CREATE TABLE IF NOT EXISTS test7( column1 BIGINT CODEC(DELTA), column2 STRING CODEC(GZIP), column3 BIGINT UNSIGNED CODEC(), column4 BOOLEAN, column5 DOUBLE CODEC(GORILLA), TAGS(column6, column7)); --
422 Unprocessable Entity
{"error_code":"0100000","error_message":"Error executiong query: Failed to do execute statement, err:Failed to do parse. err: sql parser error: ) is not a codec"}
-- ERROR:  --

-- EXECUTE SQL: DROP DATABASE IF EXISTS createtable; --
200 OK


